SELECT K0, avg(c21) FROM tbl1 JOIN (SELECT K1, c21 FROM tbl2) AS t2 ON (tbl1.K1 = t2.K1) WHERE c13 > 400 GROUP BY K0;